
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Query Merge vs Insert Merge &#8212; Data Platform Field Docs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'vast_database/ingestion/query_time_merge';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Spark Query Time Merge (id)" href="spark_merge_on_read_with_id.html" />
    <link rel="prev" title="Trino with Vast Data" href="trino.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Data Platform Field Docs - Home"/>
    <img src="../../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Data Platform Field Docs - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Platform</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../vast_dataplatform/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vast_dataplatform/architectures.html">Reference Architectures</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Datastore</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../vast_datastore/overview.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vast_datastore/vastpy/overview.html">Vastpy Library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vast_datastore/vastpy/enablecatalog.html">Enable Catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vast_datastore/vastpy/vastdb_py_setup.html">Vast DB set up using API</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vast_datastore/nifi/overview.html">Apache NiFi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vast_datastore/nifi/quickstart.html">NiFi 2.x Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vast_datastore/nifi/tagging_s3/overview.html">Tagging Datastore S3 Objects</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../vast_datastore/kafka_connect.html">Kafka Connect to Vast S3</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Database</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview/overview.html">Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../overview/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview/limits.html">Dimensions and Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview/datatypes.html">Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview/nrt.html">Near real-time workloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview/replication.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="ingestion.html">Data Ingest/Transformation</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="python.html">Python Data Ingestion</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_sdk_json_import.html">Python SDK - import JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_sdk_csv_import.html">Python SDK - import CSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_sdk_parquet_import.html">Python SDK - import Parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_sdk_grib2_import.html">Python SDK - import Grib2</a></li>
<li class="toctree-l2"><a class="reference internal" href="nifi.html">Apache NiFi</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark.html">Spark Data Ingestion</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_kafka.html">Kafka via Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark_streaming_python_sdk.html">Kafka via Spark Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="trino.html">Trino with Vast Data</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Query Merge vs Insert Merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark_merge_on_read_with_id.html">Spark Query Time Merge (id)</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark_merge_on_read_without_id.html">Spark Query Time Merge (non-id)</a></li>
<li class="toctree-l2"><a class="reference internal" href="trino_merge_on_read_with_id.html">Trino Query Time Merge (id)</a></li>
<li class="toctree-l2"><a class="reference internal" href="trino_merge_on_read_without_id.html">Trino Query Time Merge (non-id)</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache_beam_python.html">Apache Beam Sink (Python)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../query/query.html">Data Querying</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../query/dremio_quickstart/howto.html">Dremio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../query/python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../query/spark.html">Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../query/trino.html">Trino</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sdk_ref/intro.html">Python SDK Guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/create_session.html">Create Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/schema_management.html">Scheme Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/table_management.html">Table Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/column_management.html">Column Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/querying.html">Querying Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/limit_n.html">Query with ‘LIMIT n’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/projections.html">Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/manipulation.html">Manipulating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/verify_parquet.html">Utility: Verify Parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/importing_files.html">Importing Files using API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/importing_files_pandas.html">Importing Files using Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/snapshots.html">Snapshots Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/transactions.html">Transaction Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/tuning.html">Performance Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sdk_ref/recordbatchreader.html">RecordBatchReader functionality</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spark/overview.html">Apache Spark</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../spark/operations_guide.html">Spark Operations Guide</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tuning/tuning.html">Performance Tuning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tuning/python/howto.html">Tuning Python SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tuning/trino/howto.html">Tuning Trino</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../nifi/overview.html">Apache NiFi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../nifi/quickstart.html">NiFi 2.x Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi/bulk_import.html">Bulk Import from S3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nifi/salesforce/query.html">Salesforce to VAST DB</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../trino/overview.html">Trino</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../trino/quickstart.html">Trino Quickstart</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../admin/overview.html">Admininstration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../admin/vastdb_py_setup.html">Vast DB set up using API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admin/restore.html">VastDB restore procedure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admin/secure_deployment.html">Secure Deployment Pattern</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../misc/overview.html">Extras</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/python_sdk_json_import.html">Python SDK - import JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/python_sdk_csv_import.html">Python SDK - import CSV</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Catalog</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../vast_catalog/overview.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vast_catalog/python-sdk-vast-catalog.html">Python SDK Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vast_catalog/trino_quickstart/howto.html">Trino Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vast_catalog/blogs/intro.html">Blogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vast_catalog/jupyter/catalog.html">Query Catalog via Jupyter and Trino</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vast_catalog/jupyter/auditlog.html">Query Audit Log via Jupyter and Trino</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Data Engine</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../vast_dataengine/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vast_dataengine/getting_started.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Site Info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../feedback/intro.html">Feedback</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vast-data/data-platform-field-docs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vast-data/data-platform-field-docs/issues/new?title=Issue%20on%20page%20%2Fvast_database/ingestion/query_time_merge.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/vast_database/ingestion/query_time_merge.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Query Merge vs Insert Merge</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#flexibility-in-handling-updates">1. Flexibility in Handling Updates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-latency-and-cost-for-real-time-updates">2. Reduced Latency and Cost for Real-Time Updates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ease-of-implementing-complex-business-logic">3. Ease of Implementing Complex Business Logic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimizing-data-duplication-and-ensuring-fresh-data">4. Minimizing Data Duplication and Ensuring Fresh Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improved-query-performance">5. Improved Query Performance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simplified-data-management-and-maintenance">6. Simplified Data Management and Maintenance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#better-integration-with-streaming-data">7. Better Integration with Streaming Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="query-merge-vs-insert-merge">
<h1>Query Merge vs Insert Merge<a class="headerlink" href="#query-merge-vs-insert-merge" title="Link to this heading">#</a></h1>
<p>A <strong>query-time merge</strong> and an <strong>insert-time merge</strong> are both approaches used to combine or update records in a dataset, but they occur at different stages of the data pipeline. Here are the key benefits of performing a merge at <strong>query time</strong> instead of <strong>insert time</strong>:</p>
<hr class="docutils" />
<section id="flexibility-in-handling-updates">
<h2>1. Flexibility in Handling Updates<a class="headerlink" href="#flexibility-in-handling-updates" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Query-Time Merge:</p>
<ul>
<li><p><strong>Dynamic Processing</strong>: Allows for on-the-fly merging of data as the query is executed. This means you can apply the latest updates, filter duplicates, or combine datasets in real-time, without needing to modify the underlying data structure or re-write records.</p></li>
<li><p><strong>Multiple Data Sources</strong>: Query-time merges can be used to combine data from multiple sources (e.g., different tables, streams, or datasets) dynamically during querying, making it more flexible.</p></li>
<li><p><strong>Adaptability</strong>: It can adapt to different scenarios or business rules at runtime (e.g., different aggregation rules or data filtering strategies).</p></li>
</ul>
</li>
<li><p>Insert-Time Merge:</p>
<ul>
<li><p><strong>Static Processing</strong>: Data is merged at the time of insertion or update, requiring more rigid rules and pre-defined logic. Once the data is inserted into the system, it is typically more difficult to adjust without re-inserting or re-processing the data.</p></li>
<li><p><strong>Less Flexibility</strong>: If the logic needs to change or the dataset structure needs modification, it may require additional processing steps or even re-insertion of data.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="reduced-latency-and-cost-for-real-time-updates">
<h2>2. Reduced Latency and Cost for Real-Time Updates<a class="headerlink" href="#reduced-latency-and-cost-for-real-time-updates" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Query-Time Merge:</p>
<ul>
<li><p><strong>No Immediate Need for Full Data Reload</strong>: In query-time merging, you don’t need to reinsert or re-merge the data at the source, saving on the cost and time associated with re-processing large amounts of data.</p></li>
<li><p><strong>Real-Time Consistency</strong>: You can always pull the latest data from the source without worrying about lag from previously merged states. If a new record is inserted or updated, it is dynamically incorporated into query results without modifying the base data.</p></li>
</ul>
</li>
<li><p>Insert-Time Merge:</p>
<ul>
<li><p><strong>Latency Costs</strong>: Re-merging data at insert time, especially when large datasets are involved, can introduce significant latency. The merging operation may require complex data handling and possibly locking or restructuring the underlying data storage.</p></li>
<li><p><strong>High Overhead</strong>: Each insert can trigger a merge, leading to higher processing costs, especially when dealing with frequent updates.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="ease-of-implementing-complex-business-logic">
<h2>3. Ease of Implementing Complex Business Logic<a class="headerlink" href="#ease-of-implementing-complex-business-logic" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Query-Time Merge:</p>
<ul>
<li><p><strong>Complex Merge Logic</strong>: Query-time merges allow for more complex business logic to be applied dynamically. For example, you can merge data based on multiple conditions, use advanced filters, or apply aggregation on the fly without altering the source data.</p></li>
<li><p><strong>Data Transformation</strong>: It is easier to apply transformations, clean the data, or filter out unwanted records during the merge process in a query.</p></li>
</ul>
</li>
<li><p>Insert-Time Merge:</p>
<ul>
<li><p><strong>Predefined Rules</strong>: Insert-time merges are typically based on predefined rules that are difficult to change once the data is inserted. Adding new logic might require reprocessing or re-inserting records.</p></li>
<li><p><strong>Limited Flexibility</strong>: The merge logic is usually constrained to what was originally set up during the insertion, meaning any new conditions or adjustments could be cumbersome to implement.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="minimizing-data-duplication-and-ensuring-fresh-data">
<h2>4. Minimizing Data Duplication and Ensuring Fresh Data<a class="headerlink" href="#minimizing-data-duplication-and-ensuring-fresh-data" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Query-Time Merge:</p>
<ul>
<li><p><strong>Minimized Data Redundancy</strong>: Since the merge is happening when the query is executed, the system doesn’t have to keep redundant copies of data to handle updates, keeping storage costs lower.</p></li>
<li><p><strong>Access to Fresh Data</strong>: Every time a query runs, it reflects the most up-to-date view of the data. This ensures that there is no discrepancy between what is stored and what is being queried, offering real-time consistency without needing re-insertion.</p></li>
</ul>
</li>
<li><p>Insert-Time Merge:</p>
<ul>
<li><p><strong>Possible Duplication</strong>: Insert-time merges can introduce duplication as the data might be inserted multiple times with minor modifications, requiring extra steps to deduplicate before merging.</p></li>
<li><p><strong>Risk of Stale Data</strong>: The insert-time approach doesn’t always ensure that you’re querying the latest data since the merge happens once upon insertion. Any updates might require further processing to ensure the data is correctly merged.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="improved-query-performance">
<h2>5. Improved Query Performance<a class="headerlink" href="#improved-query-performance" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Query-Time Merge:</p>
<ul>
<li><p><strong>Optimized for Analytics</strong>: When querying large datasets, query-time merges can be more performance-efficient because they operate on data that’s already indexed or partitioned. This allows queries to filter, aggregate, and merge data at high speed.</p></li>
<li><p><strong>Less Data Movement</strong>: By performing merges at query time, there is no need for expensive data movements or updates across distributed systems unless necessary for the query itself.</p></li>
</ul>
</li>
<li><p>Insert-Time Merge:</p>
<ul>
<li><p><strong>Increased Storage Access</strong>: Insert-time merges require additional data movement (e.g., rewrites or updates), which could negatively affect system performance, especially when frequent updates or inserts occur.</p></li>
<li><p><strong>Heavy Resource Utilization</strong>: If the merge requires substantial processing resources (e.g., large joins or aggregations), it can significantly impact the performance of the data ingestion process.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="simplified-data-management-and-maintenance">
<h2>6. Simplified Data Management and Maintenance<a class="headerlink" href="#simplified-data-management-and-maintenance" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Query-Time Merge:</p>
<ul>
<li><p><strong>Minimal Impact on Source Data</strong>: Since no changes are made to the source data, it simplifies data management and maintenance. You avoid the complexity of keeping track of versioning or managing intermediate states of merged data.</p></li>
<li><p><strong>On-Demand Results</strong>: You can compute results on demand, adjusting the merge logic as needed without affecting the source data or necessitating long-term storage changes.</p></li>
</ul>
</li>
<li><p>Insert-Time Merge:</p>
<ul>
<li><p><strong>Data Consistency Complexity</strong>: Keeping track of the latest version of records at insert time can increase complexity, particularly when dealing with versioning, timestamps, or ensuring consistency across multiple sources.</p></li>
<li><p><strong>Need for Additional Steps</strong>: Data quality issues may arise when merging at insert time, especially if there are discrepancies between data at insertion and what is expected at query time.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="better-integration-with-streaming-data">
<h2>7. Better Integration with Streaming Data<a class="headerlink" href="#better-integration-with-streaming-data" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Query-Time Merge:</p>
<ul>
<li><p><strong>Integration with Streaming Systems</strong>: Query-time merge is ideal for systems where data is continuously ingested, such as streaming data sources. The merging can occur dynamically as new data streams in, without requiring manual intervention or reprocessing.</p></li>
</ul>
</li>
<li><p>Insert-Time Merge:</p>
<ul>
<li><p><strong>Complexity with Streams</strong>: Handling real-time streams or rapidly arriving data is harder with insert-time merges because each new insert requires additional computation to merge and update the dataset, which may not be optimal for low-latency requirements.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>In summary, <strong>query-time merge</strong> offers several significant advantages over <strong>insert-time merge</strong>, particularly in terms of flexibility, reduced latency, and the ability to dynamically apply complex business logic. Query-time merge is ideal for scenarios where real-time updates are needed, where you have multiple data sources, or when minimizing redundancy and maintaining fresh data are critical. Insert-time merge, while still useful for simpler systems or when data consistency must be ensured upfront, tends to be less flexible, more resource-intensive, and can introduce higher maintenance overheads.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./vast_database/ingestion"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="trino.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Trino with Vast Data</p>
      </div>
    </a>
    <a class="right-next"
       href="spark_merge_on_read_with_id.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spark Query Time Merge (id)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#flexibility-in-handling-updates">1. Flexibility in Handling Updates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-latency-and-cost-for-real-time-updates">2. Reduced Latency and Cost for Real-Time Updates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ease-of-implementing-complex-business-logic">3. Ease of Implementing Complex Business Logic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimizing-data-duplication-and-ensuring-fresh-data">4. Minimizing Data Duplication and Ensuring Fresh Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improved-query-performance">5. Improved Query Performance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simplified-data-management-and-maintenance">6. Simplified Data Management and Maintenance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#better-integration-with-streaming-data">7. Better Integration with Streaming Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By VAST Data
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
  <a href="https://vast-data.github.io/data-platform-field-docs/feedback/intro.html">Provide Feedback</a>
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>