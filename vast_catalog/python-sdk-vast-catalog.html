
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Python SDK Reference &#8212; Data Platform Field Docs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'vast_catalog/python-sdk-vast-catalog';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Trino Quickstart" href="trino_quickstart/howto.html" />
    <link rel="prev" title="Introduction" href="overview.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Data Platform Field Docs - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Data Platform Field Docs - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Platform</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../vast_dataplatform/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vast_dataplatform/architectures.html">Reference Architectures</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Datastore</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../vast_datastore/overview.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_datastore/vastpy/overview.html">Vastpy Library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_datastore/vastpy/enablecatalog.html">Enable Catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_datastore/vastpy/vastdb_py_setup.html">Vast DB set up using API</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_datastore/nifi/overview.html">Apache NiFi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_datastore/nifi/quickstart.html">NiFi 2.x Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_datastore/nifi/tagging_s3/overview.html">Tagging Datastore S3 Objects</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../vast_datastore/kafka_connect.html">Kafka Connect to Vast S3</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Database</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/overview/overview.html">Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/overview/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/overview/limits.html">Dimensions and Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/overview/datatypes.html">Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/overview/nrt.html">Near real-time workloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/overview/replication.html">Replication</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../vast_database/overview/getting_started.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/ingestion/ingestion.html">Data Ingest/Transformation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/python.html">Python Data Ingestion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/python_sdk_json_import.html">Python SDK - import JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/python_sdk_csv_import.html">Python SDK - import CSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/python_sdk_parquet_import.html">Python SDK - import Parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/python_sdk_grib2_import.html">Python SDK - import Grib2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/nifi.html">Apache NiFi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/spark.html">Spark Data Ingestion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/python_kafka.html">Kafka via Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/spark_streaming_python_sdk.html">Kafka via Spark Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/trino.html">Trino with Vast Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/query_time_merge.html">Query Merge vs Insert Merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/spark_merge_on_read_with_id.html">Spark Query Time Merge (id)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/spark_merge_on_read_without_id.html">Spark Query Time Merge (non-id)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/trino_merge_on_read_with_id.html">Trino Query Time Merge (id)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/trino_merge_on_read_without_id.html">Trino Query Time Merge (non-id)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/ingestion/apache_beam_python.html">Apache Beam Sink (Python)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/query/query.html">Data Querying</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/query/dremio_quickstart/howto.html">Dremio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/query/python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/query/spark.html">Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/query/trino.html">Trino</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/sdk_ref/intro.html">Python SDK Guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/create_session.html">Create Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/schema_management.html">Scheme Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/table_management.html">Table Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/column_management.html">Column Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/querying.html">Querying Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/limit_n.html">Query with ‘LIMIT n’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/projections.html">Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/manipulation.html">Manipulating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/verify_parquet.html">Utility: Verify Parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/importing_files.html">Importing Files using API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/importing_files_pandas.html">Importing Files using Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/snapshots.html">Snapshots Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/transactions.html">Transaction Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/tuning.html">Performance Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/sdk_ref/recordbatchreader.html">RecordBatchReader functionality</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/spark/overview.html">Apache Spark</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/spark/operations_guide.html">Spark Operations Guide</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/tuning/tuning.html">Performance Tuning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/tuning/python/howto.html">Tuning Python SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/tuning/trino/howto.html">Tuning Trino</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/nifi/overview.html">Apache NiFi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/nifi/quickstart.html">NiFi 2.x Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/nifi/bulk_import.html">Bulk Import from S3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/nifi/salesforce/query.html">Salesforce to VAST DB</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/trino/overview.html">Trino</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/trino/quickstart.html">Trino Quickstart</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/admin/overview.html">Admininstration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/admin/vastdb_py_setup.html">Vast DB set up using API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/admin/restore.html">VastDB restore procedure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/admin/secure_deployment.html">Secure Deployment Pattern</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vast_database/misc/overview.html">Extras</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/misc/python_sdk_json_import.html">Python SDK - import JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vast_database/misc/python_sdk_csv_import.html">Python SDK - import CSV</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Catalog</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Introduction</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Python SDK Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="trino_quickstart/howto.html">Trino Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="blogs/intro.html">Blogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter/catalog.html">Query Catalog via Jupyter and Trino</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter/auditlog.html">Query Audit Log via Jupyter and Trino</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Data Engine</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../vast_dataengine/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vast_dataengine/getting_started.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Site Info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../feedback/intro.html">Feedback</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vast-data/data-platform-field-docs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vast-data/data-platform-field-docs/issues/new?title=Issue%20on%20page%20%2Fvast_catalog/python-sdk-vast-catalog.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/vast_catalog/python-sdk-vast-catalog.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Python SDK Reference</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deploy-boto3-library-for-s3">Deploy boto3 library for S3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-demo-environment">Setup demo environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#upload-s3-object">Upload S3 Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-user-tags-to-existing-files-objects-using-s3-api">Add user tags to existing files/objects using S3 API</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-user-tags-to-existing-files-objects-using-s3-api">Get user tags to existing files/objects using S3 API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-vast-db-catalog-session">Create VAST DB Catalog Session</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-elements-are-in-the-catalog">How many elements are in the catalog</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-files-objects">How many files/objects?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-directories">How many directories?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-database-tables">How many Database tables?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-all-of-the-elements-on-my-system-anyway">What are all of the elements on my system anyway?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplified-example-of-count-of-elements-returned-from-parallel-execution">Simplified example of count of elements returned from parallel execution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-filtering">Simple Filtering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-for-specific-file-types-across-different-users">Query for Specific File Types Across Different Users:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-for-objects-based-on-user-and-specific-extensions">Query for Objects Based on User and Specific Extensions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-for-specific-file-types-with-size-constraints">Query for Specific File Types with Size Constraints</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-for-large-table-objects-by-specific-users">Query for Large TABLE Objects by Specific Users</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timestamp-filtering">Timestamp Filtering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reporting">Reporting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#capacity-grouping-usage-report">Capacity Grouping &amp; Usage report</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#catalog-snapshots-comparisons">Catalog Snapshots Comparisons</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="python-sdk-reference">
<h1>Python SDK Reference<a class="headerlink" href="#python-sdk-reference" title="Link to this heading">#</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This notebook is in the process of being migrated to Vast Data Platform Field Docs.  It will probably not run yet.</p>
</div>
<section id="deploy-boto3-library-for-s3">
<h2>Deploy boto3 library for S3<a class="headerlink" href="#deploy-boto3-library-for-s3" title="Link to this heading">#</a></h2>
<p>We will download the boto3 standard S3 library to get data into the S3 compatible VAST Datastore</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--quiet<span class="w"> </span>boto3<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-5
</pre></div>
</div>
</div>
</div>
</section>
<section id="setup-demo-environment">
<h2>Setup demo environment<a class="headerlink" href="#setup-demo-environment" title="Link to this heading">#</a></h2>
<p>Setup Python’s behavior to be more strict, including raising errors for some cases where variables are accidentally undefined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>  <span class="c1"># Enable stricter type checking</span>
</pre></div>
</div>
</div>
</div>
<p>Import some utility functions for this demo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>  
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;../misc/&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">vastdb_demo_util</span> <span class="kn">import</span> <span class="n">get_connection_vars</span><span class="p">,</span> <span class="n">upload_to_s3</span><span class="p">,</span> <span class="n">delete_s3_object</span><span class="p">,</span> <span class="n">list_objects_in_bucket</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="upload-s3-object">
<h2>Upload S3 Object<a class="headerlink" href="#upload-s3-object" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">from</span> <span class="nn">botocore.exceptions</span> <span class="kn">import</span> <span class="n">NoCredentialsError</span>

<span class="c1">#upload_to_s3(local_file_path, bucket_name, s3_file_key, aws_access_key_id, aws_secret_access_key, s3_endpoint)</span>

<span class="c1"># List objects in the bucket</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uploaded Object&quot;</span><span class="p">)</span>
<span class="n">list_objects_in_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="p">,</span> <span class="n">s3_endpoint</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Uploaded Object
Objects in bucket vastdb with prefix &#39;&#39;:
nyc-taxi/2011-01.data.parquet
nyc-taxi/2011-02.data.parquet
nyc-taxi/2011-03.data.parquet
nyc-taxi/2011-04.data.parquet
nyc-taxi/2011-05.data.parquet
nyc-taxi/2011-06.data.parquet
nyc-taxi/2011-07.data.parquet
nyc-taxi/2011-08.data.parquet
nyc-taxi/2011-09.data.parquet
nyc-taxi/2011-10.data.parquet
nyc-taxi/2011-11.data.parquet
nyc-taxi/2011-12.data.parquet
nyc-taxi/2012-01.data.parquet
nyc-taxi/2012-02.data.parquet
nyc-taxi/2012-03.data.parquet
nyc-taxi/2012-04.data.parquet
nyc-taxi/2012-05.data.parquet
nyc-taxi/2012-06.data.parquet
nyc-taxi/2012-07.data.parquet
nyc-taxi/2012-08.data.parquet
nyc-taxi/2012-09.data.parquet
nyc-taxi/2012-10.data.parquet
nyc-taxi/2012-11.data.parquet
nyc-taxi/2012-12.data.parquet
nyc-taxi/2013-01.data.parquet
nyc-taxi/2013-02.data.parquet
nyc-taxi/2013-03.data.parquet
nyc-taxi/2013-04.data.parquet
nyc-taxi/2013-05.data.parquet
nyc-taxi/2013-06.data.parquet
nyc-taxi/2013-07.data.parquet
nyc-taxi/2013-08.data.parquet
nyc-taxi/2013-09.data.parquet
nyc-taxi/2013-10.data.parquet
nyc-taxi/2013-11.data.parquet
nyc-taxi/2013-12.data.parquet
nyc-taxi/2014-01.data.parquet
nyc-taxi/2014-02.data.parquet
nyc-taxi/2014-03.data.parquet
nyc-taxi/2014-04.data.parquet
nyc-taxi/2014-05.data.parquet
nyc-taxi/2014-06.data.parquet
nyc-taxi/2014-07.data.parquet
nyc-taxi/2014-08.data.parquet
nyc-taxi/2014-09.data.parquet
nyc-taxi/2014-10.data.parquet
nyc-taxi/2014-11.data.parquet
nyc-taxi/2014-12.data.parquet
nyc-taxi/2015-01.data.parquet
nyc-taxi/2015-02.data.parquet
nyc-taxi/2015-03.data.parquet
nyc-taxi/2015-04.data.parquet
nyc-taxi/2015-05.data.parquet
nyc-taxi/2015-06.data.parquet
nyc-taxi/2015-07.data.parquet
nyc-taxi/2015-08.data.parquet
nyc-taxi/2015-09.data.parquet
nyc-taxi/2015-10.data.parquet
nyc-taxi/2015-11.data.parquet
nyc-taxi/2015-12.data.parquet
nyc-taxi/2016-01.data.parquet
nyc-taxi/2016-02.data.parquet
nyc-taxi/2016-03.data.parquet
nyc-taxi/2016-04.data.parquet
nyc-taxi/2016-05.data.parquet
nyc-taxi/2016-06.data.parquet
nyc-taxi/2016-07.data.parquet
nyc-taxi/2016-08.data.parquet
nyc-taxi/2016-09.data.parquet
nyc-taxi/2016-10.data.parquet
nyc-taxi/2016-11.data.parquet
nyc-taxi/2016-12.data.parquet
nyc-taxi/2017-01.data.parquet
nyc-taxi/2017-02.data.parquet
nyc-taxi/2017-03.data.parquet
nyc-taxi/2017-04.data.parquet
nyc-taxi/2017-05.data.parquet
nyc-taxi/2017-06.data.parquet
nyc-taxi/2017-07.data.parquet
nyc-taxi/2017-08.data.parquet
nyc-taxi/2017-09.data.parquet
nyc-taxi/2017-10.data.parquet
nyc-taxi/2017-11.data.parquet
nyc-taxi/2017-12.data.parquet
nyc-taxi/2018-01.data.parquet
nyc-taxi/2018-02.data.parquet
nyc-taxi/2018-03.data.parquet
nyc-taxi/2018-04.data.parquet
nyc-taxi/2018-05.data.parquet
nyc-taxi/2018-06.data.parquet
nyc-taxi/2018-07.data.parquet
nyc-taxi/2018-08.data.parquet
nyc-taxi/2018-09.data.parquet
nyc-taxi/2018-10.data.parquet
nyc-taxi/2018-11.data.parquet
nyc-taxi/2018-12.data.parquet
nyc-taxi/2019-01.data.parquet
nyc-taxi/2019-02.data.parquet
nyc-taxi/2019-03.data.parquet
nyc-taxi/2019-04.data.parquet
nyc-taxi/2019-05.data.parquet
nyc-taxi/2019-06.data.parquet
tabular_schema_table
tpcds/
vastschema/taxi
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uploaded Object&quot;</span><span class="p">)</span>
<span class="n">list_objects_in_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="p">,</span> <span class="n">s3_endpoint</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;labimage4.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Uploaded Object
No objects found in bucket vastdb with prefix &#39;labimage4.png&#39;.
</pre></div>
</div>
</div>
</div>
<section id="add-user-tags-to-existing-files-objects-using-s3-api">
<h3>Add user tags to existing files/objects using S3 API<a class="headerlink" href="#add-user-tags-to-existing-files-objects-using-s3-api" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">from</span> <span class="nn">botocore.exceptions</span> <span class="kn">import</span> <span class="n">NoCredentialsError</span>

<span class="k">def</span> <span class="nf">add_tags_to_s3_object</span><span class="p">(</span><span class="n">access_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">endpoint_url</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
    <span class="c1"># Create an S3 client with custom configurations</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
        <span class="s1">&#39;s3&#39;</span><span class="p">,</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">access_key</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">secret_key</span><span class="p">,</span>
        <span class="n">endpoint_url</span><span class="o">=</span><span class="n">endpoint_url</span><span class="p">,</span>
        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># Set to False to disable SSL verification</span>
    <span class="p">)</span>

    <span class="c1"># Add tags to the existing S3 object</span>
    <span class="n">s3</span><span class="o">.</span><span class="n">put_object_tagging</span><span class="p">(</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
        <span class="n">Tagging</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;TagSet&#39;</span><span class="p">:</span> <span class="n">tags</span><span class="p">}</span>
    <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Replace these values with your AWS credentials, S3 endpoint, bucket name, object key, and desired tags</span>
    <span class="n">aws_access_key</span> <span class="o">=</span> <span class="s1">&#39;BGU86QBVQBX0A71S4PTL&#39;</span>
    <span class="n">aws_secret_key</span> <span class="o">=</span> <span class="s1">&#39;LOUtdwqsgoyUxc5EG+204RRi1gQqbm1wNWJGMbJ0&#39;</span>
    <span class="n">s3_endpoint</span> <span class="o">=</span> <span class="s1">&#39;http://localhost:55555&#39;</span>  <span class="c1"># e.g., &#39;https://s3.example.com&#39;</span>
    <span class="n">bucket_name</span> <span class="o">=</span> <span class="s1">&#39;vastdb&#39;</span>
    <span class="n">object_key</span> <span class="o">=</span> <span class="s1">&#39;nyc-taxi/2015-10.data.parquet&#39;</span>
    <span class="n">user_defined_tags</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;Key&#39;</span><span class="p">:</span> <span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="s1">&#39;Boston&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;Key&#39;</span><span class="p">:</span> <span class="s1">&#39;Lab_Device_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="s1">&#39;11111&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;Key&#39;</span><span class="p">:</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="s1">&#39;xRNA&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;Key&#39;</span><span class="p">:</span> <span class="s1">&#39;Experiment_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="s1">&#39;3333&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;Key&#39;</span><span class="p">:</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="s1">&#39;Processing&#39;</span><span class="p">}</span>
        <span class="c1"># Add more tags as needed</span>
    <span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">add_tags_to_s3_object</span><span class="p">(</span><span class="n">aws_access_key</span><span class="p">,</span> <span class="n">aws_secret_key</span><span class="p">,</span> <span class="n">s3_endpoint</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_key</span><span class="p">,</span> <span class="n">user_defined_tags</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tags added successfully to S3 object: s3://</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">object_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">NoCredentialsError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AWS credentials not available.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error adding tags: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tags added successfully to S3 object: s3://vastdb/nyc-taxi/2015-10.data.parquet
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="get-user-tags-to-existing-files-objects-using-s3-api">
<h2>Get user tags to existing files/objects using S3 API<a class="headerlink" href="#get-user-tags-to-existing-files-objects-using-s3-api" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">from</span> <span class="nn">botocore.exceptions</span> <span class="kn">import</span> <span class="n">NoCredentialsError</span>

<span class="k">def</span> <span class="nf">list_tags_of_s3_object</span><span class="p">(</span><span class="n">access_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">endpoint_url</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="c1"># Create an S3 client with custom configurations</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
        <span class="s1">&#39;s3&#39;</span><span class="p">,</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">access_key</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">secret_key</span><span class="p">,</span>
        <span class="n">endpoint_url</span><span class="o">=</span><span class="n">endpoint_url</span><span class="p">,</span>
        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># Set to False to disable SSL verification</span>
    <span class="p">)</span>

    <span class="c1"># Get the tags associated with the S3 object</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">get_object_tagging</span><span class="p">(</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">key</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;TagSet&#39;</span><span class="p">]</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Replace these values with your AWS credentials, S3 endpoint, bucket name, and object key</span>
    <span class="n">aws_access_key</span> <span class="o">=</span> <span class="s1">&#39;BGU86QBVQBX0A71S4PTL&#39;</span>
    <span class="n">aws_secret_key</span> <span class="o">=</span> <span class="s1">&#39;LOUtdwqsgoyUxc5EG+204RRi1gQqbm1wNWJGMbJ0&#39;</span>
    <span class="n">s3_endpoint</span> <span class="o">=</span> <span class="s1">&#39;http://localhost:55555&#39;</span>  <span class="c1"># e.g., &#39;https://s3.example.com&#39;</span>
    <span class="n">bucket_name</span> <span class="o">=</span> <span class="s1">&#39;vastdb&#39;</span>
    <span class="n">object_key</span> <span class="o">=</span> <span class="s1">&#39;nyc-taxi/2018-06.data.parquet&#39;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">object_tags</span> <span class="o">=</span> <span class="n">list_tags_of_s3_object</span><span class="p">(</span><span class="n">aws_access_key</span><span class="p">,</span> <span class="n">aws_secret_key</span><span class="p">,</span> <span class="n">s3_endpoint</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">object_key</span><span class="p">)</span>
        
        <span class="c1"># Print the tags associated with the S3 object</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tags for S3 object: s3://</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">object_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">object_tags</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key: </span><span class="si">{</span><span class="n">tag</span><span class="p">[</span><span class="s1">&#39;Key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Value: </span><span class="si">{</span><span class="n">tag</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
    <span class="k">except</span> <span class="n">NoCredentialsError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AWS credentials not available.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error listing tags: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tags for S3 object: s3://vastdb/nyc-taxi/2018-06.data.parquet
Key: Experiment_ID, Value: 3333
Key: Lab_Device_ID, Value: 11111
Key: Location, Value: Basel
Key: Status, Value: Processing
Key: Type, Value: xRNA
</pre></div>
</div>
</div>
</div>
<section id="create-vast-db-catalog-session">
<h3>Create VAST DB Catalog Session<a class="headerlink" href="#create-vast-db-catalog-session" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vastdb.api</span> <span class="kn">import</span> <span class="n">VastdbApi</span>
<span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>

<span class="k">def</span> <span class="nf">create_vastdb_session</span><span class="p">(</span><span class="n">access_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">VastdbApi</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost:55555&#39;</span><span class="p">,</span> <span class="n">access_key</span><span class="o">=</span><span class="n">access_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="n">secret_key</span><span class="p">)</span>


<span class="n">bucket_name</span><span class="o">=</span><span class="s1">&#39;vastdb&#39;</span>
<span class="n">schema_name</span><span class="o">=</span><span class="s1">&#39;python-sdk&#39;</span>
<span class="n">table</span><span class="o">=</span><span class="s1">&#39;pythonsdk&#39;</span>

<span class="n">access_key</span><span class="o">=</span><span class="s1">&#39;BGU86QBVQBX0A71S4PTL&#39;</span>
<span class="n">secret_key</span><span class="o">=</span><span class="s1">&#39;LOUtdwqsgoyUxc5EG+204RRi1gQqbm1wNWJGMbJ0&#39;</span>
<span class="n">vastdb_session</span> <span class="o">=</span> <span class="n">create_vastdb_session</span><span class="p">(</span><span class="n">access_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;element_type&#39;</span><span class="p">]</span> <span class="c1"># Only need the element_type field for counting</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="how-many-elements-are-in-the-catalog">
<h3>How many elements are in the catalog<a class="headerlink" href="#how-many-elements-are-in-the-catalog" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total elements in the catalog: </span><span class="si">{</span><span class="n">total_elements</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total elements in the catalog: 345
</pre></div>
</div>
</div>
</div>
</section>
<section id="how-many-files-objects">
<h3>How many files/objects?<a class="headerlink" href="#how-many-files-objects" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;element_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of files/objects: </span><span class="si">{</span><span class="n">file_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of files/objects: 163
</pre></div>
</div>
</div>
</div>
</section>
<section id="how-many-directories">
<h3>How many directories?<a class="headerlink" href="#how-many-directories" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;element_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DIR&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of directories: </span><span class="si">{</span><span class="n">dir_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of directories: 179
</pre></div>
</div>
</div>
</div>
</section>
<section id="how-many-database-tables">
<h3>How many Database tables?<a class="headerlink" href="#how-many-database-tables" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;element_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TABLE&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of database tables: </span><span class="si">{</span><span class="n">table_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of database tables: 2
</pre></div>
</div>
</div>
</div>
</section>
<section id="what-are-all-of-the-elements-on-my-system-anyway">
<h3>What are all of the elements on my system anyway?<a class="headerlink" href="#what-are-all-of-the-elements-on-my-system-anyway" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distinct_elements</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;element_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distinct element types on the system:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">distinct_elements</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distinct element types on the system:
[&#39;FILE&#39; &#39;DIR&#39; &#39;SCHEMA&#39; &#39;TABLE&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="simplified-example-of-count-of-elements-returned-from-parallel-execution">
<h3>Simplified example of count of elements returned from parallel execution<a class="headerlink" href="#simplified-example-of-count-of-elements-returned-from-parallel-execution" title="Link to this heading">#</a></h3>
<p>The query_iterator iteratively executes a query on a database table, returning results in chunks as PyArrow RecordBatches, enabling efficient handling of large datasets by processing data in smaller, manageable segments.
Simplified example of count of elements returned from parallel execution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">query_and_count_elements</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">bucket</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">field_names</span><span class="p">):</span>
    <span class="n">elements_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">record_batch</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">query_iterator</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">elements_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">record_batch</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">elements_count</span>

<span class="c1"># Query Parameters</span>
<span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;element_type&#39;</span><span class="p">]</span>  <span class="c1"># Only need the element_type field for counting</span>

<span class="c1"># Perform the query</span>
<span class="n">total_elements</span> <span class="o">=</span> <span class="n">query_and_count_elements</span><span class="p">(</span>
    <span class="n">vastdb_session</span><span class="p">,</span> <span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">field_names</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total elements in the catalog: </span><span class="si">{</span><span class="n">total_elements</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total elements in the catalog: 345
</pre></div>
</div>
</div>
</div>
</section>
<section id="simple-filtering">
<h3>Simple Filtering<a class="headerlink" href="#simple-filtering" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">date_str</span> <span class="o">=</span> <span class="s1">&#39;2023-11-24&#39;</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span>
<span class="n">epoch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_str</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)))</span>

<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;owner_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq trinos3&#39;</span><span class="p">],</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gt 50000&#39;</span><span class="p">],</span>
    <span class="s1">&#39;creation_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;gt </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span>
    <span class="s1">&#39;tag_Location&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq Basel&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;creation_time&#39;</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="s1">&#39;owner_name&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;user_metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;user_tags&#39;</span><span class="p">,</span> <span class="s1">&#39;tag_Location&#39;</span><span class="p">]</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>creation_time</th>
      <th>uid</th>
      <th>owner_name</th>
      <th>size</th>
      <th>user_metadata</th>
      <th>user_tags</th>
      <th>tag_Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-06.data.parquet</td>
      <td>2024-03-05 15:03:21.610385219</td>
      <td>99999</td>
      <td>trinos3</td>
      <td>141083662</td>
      <td>[(s3cmd-attrs, atime:1709650655/ctime:17096506...</td>
      <td>[(Experiment_ID, 3333), (Lab_Device_ID, 11111)...</td>
      <td>Basel</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-02.data.parquet</td>
      <td>2024-03-05 15:03:28.300958652</td>
      <td>99999</td>
      <td>trinos3</td>
      <td>120274946</td>
      <td>[(s3cmd-attrs, atime:1709650666/ctime:17096506...</td>
      <td>[(Experiment_ID, 3333), (Lab_Device_ID, 11111)...</td>
      <td>Basel</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;user_metadata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([list([(&#39;s3cmd-attrs&#39;, &#39;atime:1709650655/ctime:1709650656/gid:1000/gname:vastdata/md5:76b073e4d79f2a77cb19d443e0b6d062/mode:33261/mtime:1709650656/uid:1000/uname:vastdata&#39;)])],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;user_tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([list([(&#39;Experiment_ID&#39;, &#39;3333&#39;), (&#39;Lab_Device_ID&#39;, &#39;11111&#39;), (&#39;Location&#39;, &#39;Basel&#39;), (&#39;Status&#39;, &#39;Processing&#39;), (&#39;Type&#39;, &#39;xRNA&#39;)])],
      dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="query-for-specific-file-types-across-different-users">
<h3>Query for Specific File Types Across Different Users:<a class="headerlink" href="#query-for-specific-file-types-across-different-users" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="s1">&#39;owner_name&#39;</span><span class="p">,</span> <span class="s1">&#39;element_type&#39;</span><span class="p">]</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;element_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;eq TABLE&#39;</span><span class="p">,</span> <span class="s1">&#39;eq DIR&#39;</span><span class="p">],</span>
    <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq 500&#39;</span><span class="p">,</span> <span class="s1">&#39;eq 1000&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uid</th>
      <th>owner_name</th>
      <th>element_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>477787</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>477788</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>477789</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>477790</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
    <tr>
      <th>477791</th>
      <td>1000</td>
      <td>vastdata</td>
      <td>FILE</td>
    </tr>
  </tbody>
</table>
<p>477792 rows × 3 columns</p>
</div></div></div>
</div>
</section>
<section id="query-for-objects-based-on-user-and-specific-extensions">
<h3>Query for Objects Based on User and Specific Extensions<a class="headerlink" href="#query-for-objects-based-on-user-and-specific-extensions" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="s1">&#39;extension&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">]</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq 1000&#39;</span><span class="p">,</span> <span class="s1">&#39;eq 555&#39;</span><span class="p">],</span>
    <span class="s1">&#39;extension&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq log&#39;</span><span class="p">,</span> <span class="s1">&#39;eq ldb&#39;</span><span class="p">]</span>  <span class="c1"># looking for log and ldb files</span>
<span class="p">}</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uid</th>
      <th>extension</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>log</td>
      <td>45511</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000</td>
      <td>log</td>
      <td>4050387</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000</td>
      <td>log</td>
      <td>1730</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000</td>
      <td>log</td>
      <td>104</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000</td>
      <td>log</td>
      <td>240974</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1000</td>
      <td>log</td>
      <td>47233</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1000</td>
      <td>log</td>
      <td>73391</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1000</td>
      <td>log</td>
      <td>77396</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1000</td>
      <td>log</td>
      <td>47334</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1000</td>
      <td>log</td>
      <td>40836</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1000</td>
      <td>log</td>
      <td>31460</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1000</td>
      <td>log</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1000</td>
      <td>log</td>
      <td>20002</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1000</td>
      <td>log</td>
      <td>16541</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1000</td>
      <td>log</td>
      <td>30185</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1000</td>
      <td>log</td>
      <td>16649</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1000</td>
      <td>log</td>
      <td>65283</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1000</td>
      <td>log</td>
      <td>16591</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1000</td>
      <td>log</td>
      <td>17126</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1000</td>
      <td>log</td>
      <td>2297</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1000</td>
      <td>log</td>
      <td>6602790</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1000</td>
      <td>log</td>
      <td>2421070</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1000</td>
      <td>log</td>
      <td>30947</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1000</td>
      <td>log</td>
      <td>112871</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1000</td>
      <td>log</td>
      <td>963022</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1000</td>
      <td>log</td>
      <td>12696</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1000</td>
      <td>log</td>
      <td>53285</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1000</td>
      <td>log</td>
      <td>30947</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="query-for-specific-file-types-with-size-constraints">
<h3>Query for Specific File Types with Size Constraints<a class="headerlink" href="#query-for-specific-file-types-with-size-constraints" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;element_type&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;element_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq FILE&#39;</span><span class="p">],</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gt 50000&#39;</span><span class="p">,</span> <span class="s1">&#39;lt 1000000&#39;</span><span class="p">]</span>  <span class="c1"># size between 50 KB and 1 MB</span>
<span class="p">}</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>element_type</th>
      <th>size</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FILE</td>
      <td>442558237</td>
      <td>2012-02.data.parquet</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FILE</td>
      <td>16777216</td>
      <td>upload</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FILE</td>
      <td>146758259</td>
      <td>2018-04.data.parquet</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FILE</td>
      <td>144467145</td>
      <td>2018-10.data.parquet</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FILE</td>
      <td>390453487</td>
      <td>2013-09.data.parquet</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>158</th>
      <td>FILE</td>
      <td>67108864</td>
      <td>upload</td>
    </tr>
    <tr>
      <th>159</th>
      <td>FILE</td>
      <td>346955670</td>
      <td>2014-01.data.parquet</td>
    </tr>
    <tr>
      <th>160</th>
      <td>FILE</td>
      <td>376498312</td>
      <td>2013-01.data.parquet</td>
    </tr>
    <tr>
      <th>161</th>
      <td>FILE</td>
      <td>145782225</td>
      <td>2017-11.data.parquet</td>
    </tr>
    <tr>
      <th>162</th>
      <td>FILE</td>
      <td>67108864</td>
      <td>upload</td>
    </tr>
  </tbody>
</table>
<p>163 rows × 3 columns</p>
</div></div></div>
</div>
</section>
<section id="query-for-large-table-objects-by-specific-users">
<h3>Query for Large TABLE Objects by Specific Users<a class="headerlink" href="#query-for-large-table-objects-by-specific-users" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="s1">&#39;owner_name&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;element_type&#39;</span><span class="p">]</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq 555&#39;</span><span class="p">],</span>
    <span class="s1">&#39;element_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq TABLE&#39;</span><span class="p">],</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gt 10000000&#39;</span><span class="p">]</span>  <span class="c1"># greater than 10 MB</span>
<span class="p">}</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="timestamp-filtering">
<h3>Timestamp Filtering<a class="headerlink" href="#timestamp-filtering" title="Link to this heading">#</a></h3>
<p>Query by birthdate: VAST uses a “creation_time” column to indicate when a new element is created:
This will output all objects linked after noon on September 1st. It will not output files that have been moved to a new path.</p>
<p>NOTE : Same method can be applied for acces-time (atime), modification-time (mtime) &amp; metadata-update-times (ctime).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># i.e: SELECT CONCAT(parent_path, name) FROM vast_big_catalog_table WHERE creation_time &gt; TIMESTAMP &#39;2023-09-01 12:00:01&#39;</span>

<span class="c1"># Set the timestamp for comparison</span>
<span class="n">timestamp_birthdate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2023-09-01 12:00:01&#39;</span><span class="p">)</span>

<span class="c1"># Convert the timestamp to an integer</span>
<span class="n">timestamp_birthdate_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp_birthdate</span><span class="o">.</span><span class="n">timestamp</span><span class="p">())</span>

<span class="c1"># Query the database</span>
<span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;creation_time&#39;</span><span class="p">,</span> <span class="s1">&#39;parent_path&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;creation_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;gt </span><span class="si">{</span><span class="n">timestamp_birthdate_int</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]}</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

<span class="c1"># Filter and concatenate paths</span>
<span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;creation_time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">timestamp_birthdate</span><span class="p">]</span>
<span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;full_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;parent_path&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

<span class="c1"># Print result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Objects created after 2023-09-01 12:00:01:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;full_path&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reporting">
<h3>Reporting<a class="headerlink" href="#reporting" title="Link to this heading">#</a></h3>
<p>Simple queries to tell you basic statistics on a section of the namespace
Report statistics on parts of the namespace - Summarizing files of a certain type (FILE), belonging to a specific user (uid=555), and located in a certain path (/parquet-files-bucket)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Query the database</span>
<span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="s1">&#39;used&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">]</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;search_path&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq /nyc-taxi&#39;</span><span class="p">],</span>
    <span class="s1">&#39;element_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq FILE&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

<span class="c1"># Check if DataFrame is empty</span>
<span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data returned from query. Please check filters and field names.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Perform aggregations</span>
    <span class="n">users_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
    <span class="n">files_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">kb_used_sum</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;used&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span>
    <span class="n">avg_size_kb</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span>

    <span class="c1"># Formatting results</span>
    <span class="n">formatted_results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;users&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">users_count</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Files&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">files_count</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s1">&#39;KB_Used&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kb_used_sum</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Avg_Size_KB&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">avg_size_kb</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">}</span>

    <span class="c1"># Print formatted results</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Aggregated Results:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">formatted_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No data returned from query. Please check filters and field names.
</pre></div>
</div>
</div>
</div>
</section>
<section id="capacity-grouping-usage-report">
<h3>Capacity Grouping &amp; Usage report<a class="headerlink" href="#capacity-grouping-usage-report" title="Link to this heading">#</a></h3>
<p>Here’s a report on all the users on the system:
Get Files across whole system(‘/’), group by owner_name, sum files, total and average size in kilobytes, oldest creation time, and most recent access time for each file owner.
Note - display is a IPython function which aggregates results in table format</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Querying the database</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;element_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq FILE&#39;</span><span class="p">],</span>
    <span class="s1">&#39;search_path&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq /&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;owner_name&#39;</span><span class="p">,</span> <span class="s1">&#39;used&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;creation_time&#39;</span><span class="p">,</span> <span class="s1">&#39;atime&#39;</span><span class="p">]</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Aggregating data</span>
<span class="n">aggregated_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;owner_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">Files</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;owner_name&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">),</span>
    <span class="n">KB_Used</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;used&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">),</span>
    <span class="n">Avg_Size_KB</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">),</span>
    <span class="n">Oldest_data</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;creation_time&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">Last_access</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;atime&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Formatting results</span>
<span class="n">aggregated_data</span><span class="p">[</span><span class="s1">&#39;Files&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aggregated_data</span><span class="p">[</span><span class="s1">&#39;Files&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">aggregated_data</span><span class="p">[</span><span class="s1">&#39;KB_Used&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aggregated_data</span><span class="p">[</span><span class="s1">&#39;KB_Used&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">aggregated_data</span><span class="p">[</span><span class="s1">&#39;Avg_Size_KB&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aggregated_data</span><span class="p">[</span><span class="s1">&#39;Avg_Size_KB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">aggregated_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Files</th>
      <th>KB_Used</th>
      <th>Avg_Size_KB</th>
      <th>Oldest_data</th>
      <th>Last_access</th>
    </tr>
    <tr>
      <th>owner_name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>40</td>
      <td>0</td>
      <td>0.00</td>
      <td>2024-03-05 15:21:31.916288773</td>
      <td>2024-03-05 15:25:42.213137875</td>
    </tr>
    <tr>
      <th>trinos3</th>
      <td>123</td>
      <td>30,963,037</td>
      <td>251,732.01</td>
      <td>2024-03-05 15:00:39.594759193</td>
      <td>2024-03-05 15:25:42.864619921</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="catalog-snapshots-comparisons">
<h3>Catalog Snapshots Comparisons<a class="headerlink" href="#catalog-snapshots-comparisons" title="Link to this heading">#</a></h3>
<p>You can access catalog snapshot by navigating the schema space.
The most obvious use of snapshot comparisons is delete detection, followed by move detection.
Delete detection
Query Returns: This script compares the current state with a specific historical snapshot, identifying files present in the current table but not in the snapshot, based on their element_type and search_path.
Access to Snapshot: Access to a snapshot works by querying a specific schema directory (representing the snapshot) within the bucket</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">query_table</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">vastdb_session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;vast-big-catalog-bucket&#39;</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="s1">&#39;vast_big_catalog_table&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">num_sub_splits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;full_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;parent_path&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;full_path&#39;</span><span class="p">])</span>

<span class="c1"># Query Filters</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;element_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq FILE&#39;</span><span class="p">],</span>
    <span class="s1">&#39;search_path&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;eq /&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Query the current table and the snapshot</span>
<span class="n">current_set</span> <span class="o">=</span> <span class="n">query_table</span><span class="p">(</span><span class="s1">&#39;vast_big_catalog_schema&#39;</span><span class="p">)</span>
<span class="n">snapshot_set</span> <span class="o">=</span> <span class="n">query_table</span><span class="p">(</span><span class="s1">&#39;.snapshot/bc_table_2023-12-10_13_53_36/vast_big_catalog_schema&#39;</span><span class="p">)</span>

<span class="c1"># Find differences (Current Table vs Snapshot)</span>
<span class="n">difference</span> <span class="o">=</span> <span class="n">current_set</span> <span class="o">-</span> <span class="n">snapshot_set</span>

<span class="c1"># Output</span>
<span class="k">if</span> <span class="n">difference</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span><span class="si">}</span><span class="s2"> files in the current table but not in the snapshot:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">difference</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] No differences found&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./vast_catalog"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="overview.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="trino_quickstart/howto.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Trino Quickstart</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deploy-boto3-library-for-s3">Deploy boto3 library for S3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-demo-environment">Setup demo environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#upload-s3-object">Upload S3 Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-user-tags-to-existing-files-objects-using-s3-api">Add user tags to existing files/objects using S3 API</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-user-tags-to-existing-files-objects-using-s3-api">Get user tags to existing files/objects using S3 API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-vast-db-catalog-session">Create VAST DB Catalog Session</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-elements-are-in-the-catalog">How many elements are in the catalog</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-files-objects">How many files/objects?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-directories">How many directories?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-database-tables">How many Database tables?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-all-of-the-elements-on-my-system-anyway">What are all of the elements on my system anyway?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplified-example-of-count-of-elements-returned-from-parallel-execution">Simplified example of count of elements returned from parallel execution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-filtering">Simple Filtering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-for-specific-file-types-across-different-users">Query for Specific File Types Across Different Users:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-for-objects-based-on-user-and-specific-extensions">Query for Objects Based on User and Specific Extensions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-for-specific-file-types-with-size-constraints">Query for Specific File Types with Size Constraints</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-for-large-table-objects-by-specific-users">Query for Large TABLE Objects by Specific Users</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timestamp-filtering">Timestamp Filtering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reporting">Reporting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#capacity-grouping-usage-report">Capacity Grouping &amp; Usage report</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#catalog-snapshots-comparisons">Catalog Snapshots Comparisons</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By VAST Data
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
  <a href="https://vast-data.github.io/data-platform-field-docs/feedback/intro.html">Provide Feedback</a>
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>